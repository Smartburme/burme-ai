<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Burme Ai - Main Chat</title>
  <link rel="icon" href="assets/icon.jpg" />
  <style>
    body {
      margin: 0;
      background: #000;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      color: #00ffff;
    }.title-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 15px;
  background: rgba(0, 0, 0, 0.9);
  box-shadow: 0 0 5px #00ffff55;
}

.title-text {
  flex-grow: 1;
  text-align: center;
  font-size: 18px;
  font-weight: bold;
}

.chat-container {
  flex-grow: 1;
  position: relative;
  background: #111;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  padding: 10px;
}

.hint-group {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 30%;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 1;
}

.hint-box {
  background: rgba(0, 255, 255, 0.05);
  border: 1px solid #00ffff33;
  border-radius: 10px;
  padding: 12px;
  font-size: 14px;
  color: #ccc;
  text-align: center;
}

.hint-box strong {
  color: #00ffff;
}

.chat-message {
  background: rgba(0, 255, 255, 0.05);
  color: white;
  padding: 10px;
  border-radius: 10px;
  margin: 5px 0;
  max-width: 90%;
}

.chat-message.user {
  align-self: flex-end;
  background: rgba(0, 255, 255, 0.4);
}

.chat-message.bot {
  align-self: flex-start;
  border-left: 3px solid #00ffff66;
}

.input-bar {
  display: flex;
  flex-direction: column;
  background: #000;
  box-shadow: 0 -2px 5px #00ffff44;
  padding: 8px;
}

.input-row {
  display: flex;
  align-items: center;
  gap: 6px;
}

.input-bar textarea {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: none;
  font-size: 14px;
  resize: none;
  background: #222;
  color: #00ffff;
}

.icon-button, select {
  font-size: 14px;
  background: #00ffff;
  color: black;
  border: none;
  border-radius: 8px;
  padding: 6px 10px;
  cursor: pointer;
  font-weight: bold;
}

.tag-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 5px;
}

.tag {
  background: #000;
  color: #00ffff;
  padding: 3px 8px;
  border-radius: 8px;
  font-size: 12px;
}

img.generated-image {
  max-width: 100%;
  border-radius: 10px;
  margin: 10px 0;
  border: 1px solid #00ffff22;
}

@media (max-width: 600px) {
  .hint-group {
    width: 80%;
  }
}

  </style>
</head>
<body>
  <div class="title-bar">
    <a href="setting.html" style="text-decoration: none; color: #00ffff; font-size: 22px;">„Éü</a>
    <div class="title-text">Burme Ai</div>
    <img src="assets/icon.jpg" alt="icon" width="30" height="30" style="border-radius: 50%;" />
  </div>  <div class="chat-container" id="chatContainer">
    <div class="hint-group" id="hintGroup">
      <div class="hint-box"><strong>Text:</strong> üí¨ Ask anything in natural language.</div>
      <div class="hint-box"><strong>Image:</strong> üñº Describe an image to generate.</div>
      <div class="hint-box"><strong>Video:</strong> üé• Video generation not yet available.</div>
    </div>
  </div>  <div class="input-bar">
    <div class="input-row">
      <textarea id="userInput" rows="2" placeholder="Type your message..."></textarea>
      <select id="modeSelect">
        <option value="text">Text</option>
        <option value="image">Image</option>
        <option value="video">Video</option>
      </select>
      <button class="icon-button" onclick="triggerUpload()">‚öì</button>
      <button class="icon-button" onclick="sendMessage()">·ê∑</button>
    </div>
    <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="uploadImage(event)" />
    <div class="tag-bar" id="tagBar"></div>
  </div>  <script src="js/gemini.js"></script>  <script>
    const chatContainer = document.getElementById('chatContainer');
    const inputField = document.getElementById('userInput');
    const modeSelect = document.getElementById('modeSelect');
    const hintGroup = document.getElementById('hintGroup');

    inputField.addEventListener('input', () => {
      hintGroup.style.display = inputField.value.trim() ? 'none' : 'flex';
    });

    function triggerUpload() {
      document.getElementById('imageUpload').click();
    }

    async function sendMessage() {
      const text = inputField.value.trim();
      const mode = modeSelect.value;
      if (!text) return;

      addMessage(text, 'user');
      inputField.value = '';
      inputField.disabled = true;

      const loadingId = addLoadingMessage('bot');

      try {
        const result = await generateGeminiReply(text, mode);
        if (mode === 'image' && result.startsWith('http')) {
          updateMessageImageById(loadingId, result);
        } else {
          updateMessageById(loadingId, result);
        }
      } catch (err) {
        updateMessageById(loadingId, '‚ùå Error: ' + err.message);
      } finally {
        inputField.disabled = false;
      }
    }

    function uploadImage(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = e => {
        addImageMessage(e.target.result, 'user');
      };
      reader.readAsDataURL(file);

      const fileName = file.name.replace(/\.[^/.]+$/, "");
      inputField.value = `Generate an image based on: ${fileName}`;
      modeSelect.value = 'image';
      sendMessage();
    }

    function addMessage(text, sender) {
      const div = document.createElement('div');
      div.className = 'chat-message ' + sender;
      div.innerText = text;
      chatContainer.appendChild(div);
      chatContainer.scrollTop = chatContainer.scrollHeight;
      return div;
    }

    function addImageMessage(url, sender = 'bot') {
      const img = document.createElement('img');
      img.src = url;
      img.alt = "Generated Image";
      img.className = 'generated-image chat-message ' + sender;
      chatContainer.appendChild(img);
      chatContainer.scrollTop = chatContainer.scrollHeight;
      return img;
    }

    function addLoadingMessage(sender = 'bot') {
      const div = document.createElement('div');
      div.className = 'chat-message ' + sender;
      div.innerText = "‚è≥ Generating...";
      const id = 'msg-' + Date.now();
      div.dataset.id = id;
      chatContainer.appendChild(div);
      chatContainer.scrollTop = chatContainer.scrollHeight;
      return id;
    }

    function updateMessageById(id, newText) {
      const msg = [...chatContainer.children].find(el => el.dataset?.id === id);
      if (msg) msg.innerText = newText;
    }

    function updateMessageImageById(id, url) {
      const msg = [...chatContainer.children].find(el => el.dataset?.id === id);
      if (msg) {
        const img = document.createElement('img');
        img.src = url;
        img.alt = "Generated Image";
        img.className = 'generated-image chat-message bot';
        msg.replaceWith(img);
      }
    }

    window.sendMessage = sendMessage;
    window.uploadImage = uploadImage;
    window.triggerUpload = triggerUpload;
  </script></body>
</html>
